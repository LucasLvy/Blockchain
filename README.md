# TD2 programmation blockchain

## BIP 32 (2ème partie)

Nous avons décomposé cette partie en 3 fonctions c.à.d 3 manières différentes de générer des childs keys. 
* `bip32_standard` est la standard, elle prend en entrée la seed et génère d'abord les master private key `mprk` et chain code `mcc` en faisant un hash SHA-512 de la seed. Ensuite, on définit un index égal à 2^31, ce qui correspond à un index valable pour une clé renforcée (il doit être ≥ 2^31). Pour dériver l'enfant renforcé à partir du parent, on réalise un HMAC-SHA512 dont la clé est le `mcc` et le message une concaténation de cette forme : `00 || mprk || index`. Les 256 premiers bits du hash resultant sont additionés à la private key du parent pour former la private key du child. Le 256 derniers bits forment le chain code de l'enfant. La fonction retourne un tableau avec les résultats de l'enfant généré sous cette forme : `child = [privatekey, chaincode, index]`.
* `bip32_index` prend en entrée la seed et l'index voulu pour l'enfant sous forme d'entier int. Par souci de simplicité, on transforme nous même l'index en un index valable pour une clé renforcée en ajoutant systématiquement 2^31 au nombre entré. Le reste de la dérivation a le même fonctionnement que pour le `bip32_standard`, l'index a seulement été prédéfini. La fonction retourne un tableau avec les résultats de l'enfant généré sous cette forme : `child = [privatekey, chaincode, index]`.
* `bip32_index_depth` prend en entrée la seed, l'index et le niveau de dérivation voulu pour l'enfant sous forme d'entier int. Le reste de la dérivation a le même fonctionnement que pour le `bip32_standard`, seulement cette fois on réalise cette derivation autant de fois que de profondeur défini. A chaque niveau, le parent est le child du niveau précedent (ou la master key au niveau 0). De plus, on utilise un index qui s'itère sur lui même pour chaque niveau. Lorsque l'on atteint le niveau désiré en entrée, on applique l'index également choisi en entrée. La fonction retourne un tableau avec les résultats des enfants générés sous cette forme : `child[depth] = [privatekey, chaincode, index]`.
